<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor Securitate PublicƒÉ Slobozia</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .status-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-indicator.checking { 
            background: rgba(255, 193, 7, 0.3); 
            animation: pulse 2s infinite; 
        }
        .status-indicator.active { background: rgba(76, 175, 80, 0.3); }
        .status-indicator.error { background: rgba(220, 53, 69, 0.3); }

        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        .content { padding: 30px; }

        .monitoring-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border-left: 4px solid #28a745;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .status-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }

        .status-value {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .status-label {
            font-size: 11px;
            color: #6c757d;
            margin-top: 3px;
        }

        .weather-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .weather-section.warning {
            border-left: 5px solid #fd7e14;
            background: #fff8e1;
        }

        .weather-section.severe {
            border-left: 5px solid #dc3545;
            background: #fff5f5;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .refresh-btn {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 15px;
            padding: 8px 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover { background: #0056b3; }
        .refresh-btn:disabled { background: #6c757d; cursor: not-allowed; }

        .weather-current {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .weather-main {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .temperature {
            font-size: 48px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .weather-desc {
            font-size: 16px;
            color: #6c757d;
            margin-bottom: 15px;
        }

        .weather-details {
            background: white;
            padding: 20px;
            border-radius: 10px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #f1f1f1;
        }

        .detail-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .weather-alerts {
            margin-top: 15px;
        }

        .alert-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 3px solid #007bff;
        }

        .alert-item.warning {
            border-left-color: #fd7e14;
            background: #fff8e1;
        }

        .alert-item.severe {
            border-left-color: #dc3545;
            background: #fff5f5;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .alert-description {
            font-size: 13px;
            color: #495057;
            margin-bottom: 8px;
        }

        .alert-meta {
            font-size: 11px;
            color: #6c757d;
        }

        .forecast-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .forecast-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .forecast-day {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 12px;
        }

        .forecast-temp {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin: 5px 0;
        }

        .forecast-desc {
            font-size: 11px;
            color: #6c757d;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 13px;
        }

        .location-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }

        .emergency-contacts {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
        }

        .emergency-number {
            font-size: 32px;
            font-weight: 700;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .container { margin: 10px; }
            .header { padding: 20px; }
            .content { padding: 20px; }
            .status-indicator { position: static; margin-top: 10px; }
            .weather-current { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="status-indicator" id="statusIndicator">
                <span>üõ°Ô∏è</span>
                <span id="statusText">Ini»õializare...</span>
            </div>
            <h1>üõ°Ô∏è Monitor Securitate PublicƒÉ</h1>
            <p>Monitorizare Meteo & Emergen»õe - Slobozia</p>
        </div>

        <div class="content">
            <!-- Location Info -->
            <div class="location-info">
                <strong>üìç Monitorizare pentru:</strong> Slobozia, Jude»õul Ialomi»õa, Rom√¢nia<br>
                <strong>üåç Coordonate:</strong> 44.5667¬∞N, 27.3667¬∞E
            </div>

            <!-- Monitoring Status -->
            <div class="monitoring-panel">
                <h3>üìä Status Monitor</h3>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-value" id="lastUpdate">--:--</div>
                        <div class="status-label">Ultima actualizare</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="alertCount">0</div>
                        <div class="status-label">Alerte meteo</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="currentTemp">--¬∞C</div>
                        <div class="status-label">Temperatura curentƒÉ</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="nextCheck">--:--</div>
                        <div class="status-label">UrmƒÉtoarea verificare</div>
                    </div>
                </div>
            </div>

            <!-- Weather Current Conditions -->
            <div class="weather-section" id="weatherSection">
                <div class="section-header">
                    <div class="section-title">üå§Ô∏è Condi»õii Meteorologice Actuale</div>
                    <button class="refresh-btn" id="refreshBtn" onclick="loadWeatherData()">üîÑ ActualizeazƒÉ</button>
                </div>
                
                <div id="errorContainer"></div>
                <div id="weatherContainer">
                    <div class="loading">
                        <div>üîÑ Se √ÆncarcƒÉ datele meteorologice...</div>
                    </div>
                </div>
            </div>

            <!-- Weather Forecast -->
            <div class="forecast-section">
                <div class="section-title">üìÖ PrognozƒÉ 5 Zile</div>
                <div id="forecastContainer">
                    <div class="loading">
                        <div>üìä Se √ÆncarcƒÉ prognoza...</div>
                    </div>
                </div>
            </div>

            <!-- Emergency Info -->
            <div class="weather-section">
                <div class="section-title">‚ÑπÔ∏è Informa»õii Importante</div>
                <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                    <p><strong>üì± RO-ALERT:</strong> Sistemul na»õional de alertƒÉ prin SMS. Nu necesitƒÉ aplica»õie.</p>
                    <p><strong>üå¶Ô∏è ANM:</strong> Administra»õia Na»õionalƒÉ de Meteorologie - sursa oficialƒÉ pentru alerte meteo.</p>
                    <p><strong>üö® IGSU:</strong> Inspectoratul General pentru Situa»õii de Urgen»õƒÉ - gestioneazƒÉ emergen»õele.</p>
                    <p><strong>‚ö†Ô∏è Pentru vremea severƒÉ:</strong> RƒÉm√¢ne»õi √Æn interior, evita»õi deplasƒÉrile nenecesare.</p>
                </div>
            </div>

            <!-- Emergency Contacts -->
            <div class="emergency-contacts">
                <h3>üö® Urgen»õe</h3>
                <div class="emergency-number">112</div>
                <div style="margin-top: 15px; opacity: 0.9;">
                    <strong>Apel urgen»õƒÉ:</strong> 112<br>
                    <strong>Prefectura Ialomi»õa:</strong> 0243 230 001<br>
                    <strong>PrimƒÉria Slobozia:</strong> 0243 230 330
                </div>
            </div>
        </div>
    </div>

    <script>
        // Slobozia coordinates
        const SLOBOZIA_LAT = 44.5667;
        const SLOBOZIA_LON = 27.3667;
        
        let weatherData = null;
        let forecastData = null;
        let currentAlerts = [];
        let isLoading = false;

        // Weather code to description mapping
        const weatherCodes = {
            0: "Cer senin",
            1: "Predominant senin", 
            2: "Par»õial noros",
            3: "Acoperit",
            45: "Cea»õƒÉ",
            48: "Cea»õƒÉ cu chiciurƒÉ",
            51: "Burni»õƒÉ u»ôoarƒÉ",
            53: "Burni»õƒÉ moderatƒÉ", 
            55: "Burni»õƒÉ densƒÉ",
            56: "Burni»õƒÉ √Ænghe»õatƒÉ u»ôoarƒÉ",
            57: "Burni»õƒÉ √Ænghe»õatƒÉ densƒÉ",
            61: "Ploaie u»ôoarƒÉ",
            63: "Ploaie moderatƒÉ",
            65: "Ploaie toren»õialƒÉ",
            66: "Ploaie √Ænghe»õatƒÉ u»ôoarƒÉ",
            67: "Ploaie √Ænghe»õatƒÉ toren»õialƒÉ",
            71: "Ninsoare u»ôoarƒÉ",
            73: "Ninsoare moderatƒÉ",
            75: "Ninsoare abundentƒÉ",
            77: "FulguialƒÉ",
            80: "Averse u»ôoare",
            81: "Averse moderate",
            82: "Averse toren»õiale",
            85: "Averse de zƒÉpadƒÉ u»ôoare",
            86: "Averse de zƒÉpadƒÉ abundente",
            95: "FurtunƒÉ",
            96: "FurtunƒÉ cu grindinƒÉ u»ôoarƒÉ",
            99: "FurtunƒÉ cu grindinƒÉ abundentƒÉ"
        };

        function updateStatus(status, text) {
            const indicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            indicator.className = `status-indicator ${status}`;
            statusText.textContent = text;
        }

        function updateStats() {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('ro-RO');
            document.getElementById('alertCount').textContent = currentAlerts.length;
            
            if (weatherData && weatherData.current_weather) {
                document.getElementById('currentTemp').textContent = Math.round(weatherData.current_weather.temperature) + '¬∞C';
            }
            
            const nextUpdate = new Date(Date.now() + 10 * 60 * 1000);
            document.getElementById('nextCheck').textContent = nextUpdate.toLocaleTimeString('ro-RO');
        }

        function showError(message) {
            const errorContainer = document.getElementById('errorContainer');
            errorContainer.innerHTML = `
                <div class="error-message">
                    ‚ö†Ô∏è ${message}
                </div>
            `;
        }

        function clearError() {
            document.getElementById('errorContainer').innerHTML = '';
        }

        function getWeatherIcon(code) {
            if (code === 0) return "‚òÄÔ∏è";
            if (code <= 3) return "‚õÖ";
            if (code <= 48) return "üå´Ô∏è";
            if (code <= 57) return "üå¶Ô∏è";
            if (code <= 67) return "üåßÔ∏è";
            if (code <= 77) return "‚ùÑÔ∏è";
            if (code <= 82) return "üå¶Ô∏è";
            if (code <= 86) return "üå®Ô∏è";
            if (code >= 95) return "‚õàÔ∏è";
            return "üå§Ô∏è";
        }

        function analyzeWeatherForAlerts(data) {
            currentAlerts = [];
            
            if (!data.current_weather) return;
            
            const temp = data.current_weather.temperature;
            const windSpeed = data.current_weather.windspeed;
            const weatherCode = data.current_weather.weathercode;
            
            // Temperature alerts
            if (temp >= 35) {
                currentAlerts.push({
                    type: 'severe',
                    title: 'üî• AlertƒÉ CaniculƒÉ',
                    description: `TemperaturƒÉ foarte ridicatƒÉ: ${temp}¬∞C. Evita»õi expunerea la soare √Æntre 10-18.`,
                    time: new Date()
                });
            } else if (temp <= -10) {
                currentAlerts.push({
                    type: 'severe',
                    title: 'ü•∂ AlertƒÉ Ger Intens',
                    description: `TemperaturƒÉ foarte scƒÉzutƒÉ: ${temp}¬∞C. Risc de degerƒÉturi »ôi √Ænghe»õ.`,
                    time: new Date()
                });
            } else if (temp <= 0) {
                currentAlerts.push({
                    type: 'warning',
                    title: '‚ùÑÔ∏è Temperaturi Sub Zero',
                    description: `TemperaturƒÉ: ${temp}¬∞C. Aten»õie la drumuri √Ænghe≈£ate.`,
                    time: new Date()
                });
            }
            
            // Wind alerts
            if (windSpeed >= 60) {
                currentAlerts.push({
                    type: 'severe',
                    title: 'üí® AlertƒÉ V√¢nt Puternic',
                    description: `V√¢nt foarte puternic: ${windSpeed} km/h. Evita»õi deplasƒÉrile.`,
                    time: new Date()
                });
            } else if (windSpeed >= 40) {
                currentAlerts.push({
                    type: 'warning',
                    title: 'üå¨Ô∏è V√¢nt Moderat',
                    description: `V√¢nt: ${windSpeed} km/h. Aten»õie la obiecte care pot fi luate de v√¢nt.`,
                    time: new Date()
                });
            }
            
            // Severe weather alerts
            if (weatherCode >= 95) {
                currentAlerts.push({
                    type: 'severe',
                    title: '‚õàÔ∏è AlertƒÉ FurtunƒÉ',
                    description: 'FurtunƒÉ √Æn curs. RƒÉm√¢ne»õi √Æn interior »ôi evita»õi zonele deschise.',
                    time: new Date()
                });
            } else if (weatherCode >= 80) {
                currentAlerts.push({
                    type: 'warning',
                    title: 'üåßÔ∏è Averse Toren»õiale',
                    description: 'Ploi toren»õiale. Aten»õie la inunda»õii »ôi vizibilitate redusƒÉ.',
                    time: new Date()
                });
            } else if (weatherCode >= 71) {
                currentAlerts.push({
                    type: 'warning',
                    title: '‚ùÑÔ∏è Ninsoare',
                    description: 'Ninsoare √Æn curs. Aten»õie la drumurile alunecoase.',
                    time: new Date()
                });
            }
        }

        function displayWeather() {
            const container = document.getElementById('weatherContainer');
            
            if (!weatherData || !weatherData.current_weather) {
                container.innerHTML = `
                    <div class="loading">
                        <div>‚ùå Nu s-au putut √ÆncƒÉrca datele meteorologice</div>
                    </div>
                `;
                return;
            }
            
            const current = weatherData.current_weather;
            const hourly = weatherData.hourly;
            
            const temp = Math.round(current.temperature);
            const desc = weatherCodes[current.weathercode] || "Informa»õii indisponibile";
            const icon = getWeatherIcon(current.weathercode);
            const windSpeed = Math.round(current.windspeed);
            
            // Get additional data from hourly
            const currentHour = new Date().getHours();
            const humidity = hourly && hourly.relativehumidity_2m ? hourly.relativehumidity_2m[currentHour] : 'N/A';
            const precipitation = hourly && hourly.precipitation ? hourly.precipitation[currentHour] : 0;
            
            container.innerHTML = `
                <div class="weather-current">
                    <div class="weather-main">
                        <div style="font-size: 64px; margin-bottom: 10px;">${icon}</div>
                        <div class="temperature">${temp}¬∞C</div>
                        <div class="weather-desc">${desc}</div>
                    </div>
                    <div class="weather-details">
                        <div class="detail-row">
                            <span>üí® V√¢nt:</span>
                            <span>${windSpeed} km/h</span>
                        </div>
                        <div class="detail-row">
                            <span>üíß Umiditate:</span>
                            <span>${humidity}%</span>
                        </div>
                        <div class="detail-row">
                            <span>üåßÔ∏è Precipita»õii:</span>
                            <span>${precipitation} mm</span>
                        </div>
                        <div class="detail-row">
                            <span>üå°Ô∏è Resim»õitƒÉ:</span>
                            <span>${temp}¬∞C</span>
                        </div>
                        <div class="detail-row">
                            <span>üìÖ Actualizat:</span>
                            <span>${new Date().toLocaleTimeString('ro-RO')}</span>
                        </div>
                    </div>
                </div>
                ${displayAlerts()}
            `;
            
            // Update weather section styling
            const section = document.getElementById('weatherSection');
            const hasSevere = currentAlerts.some(a => a.type === 'severe');
            const hasWarning = currentAlerts.some(a => a.type === 'warning');
            
            if (hasSevere) {
                section.className = 'weather-section severe';
            } else if (hasWarning) {
                section.className = 'weather-section warning';
            } else {
                section.className = 'weather-section';
            }
        }

        function displayAlerts() {
            if (currentAlerts.length === 0) {
                return `
                    <div class="weather-alerts">
                        <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; text-align: center;">
                            ‚úÖ <strong>Nu sunt alerte meteorologice active</strong><br>
                            <small>Condi»õiile meteorologice sunt normale pentru Slobozia</small>
                        </div>
                    </div>
                `;
            }
            
            const alertsHTML = currentAlerts.map(alert => `
                <div class="alert-item ${alert.type}">
                    <div class="alert-title">${alert.title}</div>
                    <div class="alert-description">${alert.description}</div>
                    <div class="alert-meta">
                        üìÖ ${alert.time.toLocaleString('ro-RO')} ‚Ä¢ üìç Slobozia, Ialomi»õa
                    </div>
                </div>
            `).join('');
            
            return `
                <div class="weather-alerts">
                    <h4 style="margin-bottom: 10px; color: #2c3e50;">‚ö†Ô∏è Alerte Meteorologice (${currentAlerts.length})</h4>
                    ${alertsHTML}
                </div>
            `;
        }

        function displayForecast() {
            const container = document.getElementById('forecastContainer');
            
            if (!forecastData || !forecastData.daily) {
                container.innerHTML = `
                    <div class="loading">
                        <div>‚ùå Nu s-au putut √ÆncƒÉrca prognoza</div>
                    </div>
                `;
                return;
            }
            
            const daily = forecastData.daily;
            const forecastHTML = daily.time.slice(0, 5).map((date, index) => {
                const dayName = new Date(date).toLocaleDateString('ro-RO', { weekday: 'short' });
                const maxTemp = Math.round(daily.temperature_2m_max[index]);
                const minTemp = Math.round(daily.temperature_2m_min[index]);
                const weatherCode = daily.weathercode[index];
                const icon = getWeatherIcon(weatherCode);
                const desc = weatherCodes[weatherCode] || 'N/A';
                
                return `
                    <div class="forecast-item">
                        <div class="forecast-day">${dayName}</div>
                        <div style="font-size: 32px; margin: 5px 0;">${icon}</div>
                        <div class="forecast-temp">${maxTemp}¬∞/${minTemp}¬∞</div>
                        <div class="forecast-desc">${desc}</div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = `
                <div class="forecast-grid">
                    ${forecastHTML}
                </div>
            `;
        }

        async function loadWeatherData() {
            if (isLoading) return;
            
            isLoading = true;
            updateStatus('checking', 'Se √ÆncarcƒÉ vremea...');
            
            const refreshBtn = document.getElementById('refreshBtn');
            refreshBtn.disabled = true;
            refreshBtn.textContent = '‚è≥ Se √ÆncarcƒÉ...';
            
            clearError();

            try {
                // Load current weather
                const currentResponse = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${SLOBOZIA_LAT}&longitude=${SLOBOZIA_LON}&current_weather=true&hourly=relativehumidity_2m,precipitation&timezone=Europe/Bucharest`);
                
                if (!currentResponse.ok) throw new Error('Nu s-au putut √ÆncƒÉrca datele meteo');
                
                weatherData = await currentResponse.json();
                
                // Load 5-day forecast
                const forecastResponse = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${SLOBOZIA_LAT}&longitude=${SLOBOZIA_LON}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Europe/Bucharest`);
                
                if (forecastResponse.ok) {
                    forecastData = await forecastResponse.json();
                }
                
                // Analyze weather for alerts
                analyzeWeatherForAlerts(weatherData);
                
                // Display weather data
                displayWeather();
                displayForecast();
                
                updateStats();
                updateStatus('active', 'Monitor activ');
                
            } catch (error) {
                console.error('Error loading weather data:', error);
                showError('Nu s-au putut √ÆncƒÉrca datele meteorologice. Verifica»õi conexiunea la internet.');
                updateStatus('error', 'Eroare √ÆncƒÉrcare');
            } finally {
                isLoading = false;
                refreshBtn.disabled = false;
                refreshBtn.textContent = 'üîÑ ActualizeazƒÉ';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadWeatherData();
            
            // Auto-refresh every 10 minutes
            setInterval(loadWeatherData, 10 * 60 * 1000);
        });
    </script>
</body>
</html>
