<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Căutare Avansată - Poliția Locală Slobozia</title>
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #022f55;
            --primary-light: #2e5074;
            --primary-dark: #01172b;
            --secondary-color: #1e88e5;
            --secondary-light: #4aa1f8;
            --secondary-dark: #1565c0;
            --background-light: #f5f7fa;
            --text-primary: #262626;
            --text-secondary: #595959;
            --border-radius-small: 4px;
            --border-radius-medium: 8px;
            --border-radius-large: 12px;
            --shadow-small: 0 2px 5px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 4px 10px rgba(0, 0, 0, 0.1);
            --shadow-large: 0 8px 30px rgba(0, 0, 0, 0.15);
            --transition-fast: all 0.2s ease;
            --transition-medium: all 0.3s ease;
            --transition-slow: all 0.5s ease;
            --header-height: 140px;
        }
        
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-primary);
            background-color: var(--background-light);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding-top: var(--header-height); /* For fixed header */
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        a {
            text-decoration: none;
            color: var(--secondary-color);
        }
        
        /* Layout containers */
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }
        
        main {
            flex: 1;
        }
        
        /* Page title section */
        .page-title-container {
            background-color: var(--primary-color);
            padding: 2.5rem 0;
            position: relative;
            color: white;
            overflow: hidden;
        }
        
        .page-title-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            opacity: 0.1;
            z-index: 0;
        }
        
        .page-title-content {
            position: relative;
            z-index: 1;
        }
        
        .page-subtitle {
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .page-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0;
            color: white;
        }
        
        /* Header */
        .header {
            background-color: white;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: var(--shadow-small);
        }
        
        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: var(--header-height);
            padding: 0 1.5rem;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo img {
            height: 80px;
            margin-right: 1rem;
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
        }
        
        .logo-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            line-height: 1.2;
        }
        
        .logo-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
        }
        
        /* Search container */
        .search-container {
            padding: 2rem 0;
        }
        
        .search-header {
            margin-bottom: 2rem;
            position: relative;
        }
        
        .search-form {
            display: flex;
            margin-bottom: 1.5rem;
            gap: 0;
            transition: var(--transition-medium);
            position: relative;
            z-index: 2;
        }
        
        .search-form:focus-within {
            transform: translateY(-3px);
            box-shadow: var(--shadow-large);
        }
        
        .search-input {
            flex: 1;
            padding: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: var(--border-radius-medium) 0 0 var(--border-radius-medium);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            box-shadow: var(--shadow-small);
            transition: var(--transition-medium);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.1);
        }
        
        .search-button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 0 1.5rem;
            border-radius: 0 var(--border-radius-medium) var(--border-radius-medium) 0;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            white-space: nowrap;
            position: relative;
            overflow: hidden;
        }
        
        .search-button:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }
        
        .search-button:hover:before {
            width: 300%;
            height: 300%;
        }
        
        .search-button:hover {
            background-color: var(--secondary-light);
        }
        
        .search-button i {
            margin-right: 0.5rem;
        }
        
        .search-summary {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.95rem;
            opacity: 0;
            transform: translateY(10px);
            animation: fadeInUp 0.5s forwards 0.3s;
        }
        
        /* Search suggestions dropdown */
        .search-suggestions-dropdown {
            position: absolute;
            top: calc(3.5rem - 1px);
            left: 0;
            width: calc(100% - 120px);
            background-color: white;
            border-radius: 0 0 var(--border-radius-medium) var(--border-radius-medium);
            box-shadow: var(--shadow-medium);
            z-index: 100;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-top: none;
            transform-origin: top center;
            transform: scaleY(0);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .search-suggestions-dropdown.active {
            transform: scaleY(1);
            opacity: 1;
        }
        
        .search-suggestions-dropdown ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .search-suggestions-dropdown li {
            padding: 0;
            margin: 0;
            transform: translateX(-20px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .search-suggestions-dropdown.active li {
            transform: translateX(0);
            opacity: 1;
        }
        
        .search-suggestions-dropdown.active li:nth-child(1) { transition-delay: 0.05s; }
        .search-suggestions-dropdown.active li:nth-child(2) { transition-delay: 0.1s; }
        .search-suggestions-dropdown.active li:nth-child(3) { transition-delay: 0.15s; }
        .search-suggestions-dropdown.active li:nth-child(4) { transition-delay: 0.2s; }
        .search-suggestions-dropdown.active li:nth-child(5) { transition-delay: 0.25s; }
        
        .search-suggestions-dropdown a {
            display: block;
            padding: 0.8rem 1.2rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
        }
        
        .search-suggestions-dropdown a:hover {
            background-color: rgba(30, 136, 229, 0.05);
            color: var(--secondary-color);
            padding-left: 1.5rem;
        }
        
        .search-suggestions-dropdown a i {
            margin-right: 10px;
            font-size: 16px;
            color: var(--secondary-color);
            opacity: 0.7;
        }
        
        /* Sorting options */
        .sorting-options {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            background-color: white;
            padding: 0.8rem 1.2rem;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-small);
            opacity: 0;
            transform: translateY(10px);
            animation: fadeInUp 0.5s forwards 0.5s;
        }
        
        .sorting-options label {
            margin-right: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
            white-space: nowrap;
        }
        
        .sorting-options select {
            padding: 0.5rem 2rem 0.5rem 1rem;
            border: 1px solid #e0e0e0;
            border-radius: var(--border-radius-small);
            background-color: white;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23424242' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: var(--transition-fast);
        }
        
        .sorting-options select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.1);
        }
        
        /* Direct match */
        .direct-match {
            background-color: rgba(30, 136, 229, 0.05);
            border-radius: var(--border-radius-medium);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-left: 4px solid var(--secondary-color);
            display: flex;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s forwards 0.7s;
            box-shadow: var(--shadow-small);
            transition: var(--transition-medium);
        }
        
        .direct-match:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-medium);
        }
        
        .direct-match-icon {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-right: 1.5rem;
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }
        
        .direct-match-content {
            flex: 1;
        }
        
        .direct-match-content h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }
        
        .direct-match-content p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .direct-match-link {
            display: inline-flex;
            align-items: center;
            background-color: var(--secondary-color);
            color: white;
            padding: 0.7rem 1.5rem;
            border-radius: var(--border-radius-small);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition-fast);
            box-shadow: var(--shadow-small);
            position: relative;
            overflow: hidden;
        }
        
        .direct-match-link:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }
        
        .direct-match-link:hover:before {
            width: 300%;
            height: 300%;
        }
        
        .direct-match-link:hover {
            background-color: var(--secondary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }
        
        .direct-match-link i {
            margin-left: 0.5rem;
        }
        
        /* Search results */
        .search-results {
            display: flex;
            gap: 1.5rem;
        }
        
        .result-filters {
            width: 250px;
            flex-shrink: 0;
            opacity: 0;
            transform: translateX(-20px);
            animation: fadeInLeft 0.6s forwards 0.9s;
        }
        
        .filter-section {
            background-color: white;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-small);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: var(--transition-medium);
        }
        
        .filter-section:hover {
            box-shadow: var(--shadow-medium);
            transform: translateY(-3px);
        }
        
        .filter-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .filter-body {
            padding: 1rem 1.5rem;
        }
        
        .filter-option {
            display: flex;
            align-items: center;
            margin-bottom: 0.8rem;
            cursor: pointer;
            position: relative;
            transition: var(--transition-fast);
        }
        
        .filter-option:last-child {
            margin-bottom: 0;
        }
        
        .filter-option input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid #e0e0e0;
            border-radius: 3px;
            margin-right: 0.8rem;
            position: relative;
            cursor: pointer;
            transition: var(--transition-fast);
            flex-shrink: 0;
        }
        
        .filter-option input[type="checkbox"]:checked {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .filter-option input[type="checkbox"]:checked::after {
            content: '';
            position: absolute;
            left: 5px;
            top: 2px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        
        .filter-option input[type="checkbox"]:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.1);
        }
        
        .filter-option input[type="checkbox"]:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .filter-option label {
            color: var(--text-secondary);
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition-fast);
            flex: 1;
        }
        
        .filter-option:hover label {
            color: var(--secondary-color);
        }
        
        .filter-count {
            background-color: rgba(30, 136, 229, 0.1);
            color: var(--secondary-color);
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
            flex-shrink: 0;
            transition: var(--transition-fast);
        }
        
        .filter-option:hover .filter-count {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .result-list {
            flex: 1;
        }
        
        .result-card {
            background-color: white;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-small);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: var(--transition-medium);
            border-left: 3px solid transparent;
            opacity: 0;
            transform: translateY(30px);
        }
        
        .result-card:nth-child(1) { animation: fadeInUp 0.5s forwards 1.0s; }
        .result-card:nth-child(2) { animation: fadeInUp 0.5s forwards 1.1s; }
        .result-card:nth-child(3) { animation: fadeInUp 0.5s forwards 1.2s; }
        .result-card:nth-child(4) { animation: fadeInUp 0.5s forwards 1.3s; }
        .result-card:nth-child(5) { animation: fadeInUp 0.5s forwards 1.4s; }
        .result-card:nth-child(6) { animation: fadeInUp 0.5s forwards 1.5s; }
        .result-card:nth-child(7) { animation: fadeInUp 0.5s forwards 1.6s; }
        .result-card:nth-child(8) { animation: fadeInUp 0.5s forwards 1.7s; }
        .result-card:nth-child(9) { animation: fadeInUp 0.5s forwards 1.8s; }
        .result-card:nth-child(10) { animation: fadeInUp 0.5s forwards 1.9s; }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
            border-left-color: var(--secondary-color);
        }
        
        .result-meta {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .result-type {
            background-color: rgba(30, 136, 229, 0.1);
            color: var(--secondary-color);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            transition: var(--transition-fast);
        }
        
        .result-card:hover .result-type {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .result-type i {
            font-size: 1rem;
            margin-right: 0.3rem;
        }
        
        .result-url {
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition-fast);
            max-width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .result-url:hover {
            text-decoration: underline;
        }
        
        .result-title {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
            transition: var(--transition-fast);
        }
        
        .result-title a {
            text-decoration: none;
            color: inherit;
            transition: var(--transition-fast);
        }
        
        .result-title a:hover {
            color: var(--secondary-color);
        }
        
        .result-excerpt {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        
        .result-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .result-action {
            display: inline-flex;
            align-items: center;
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition-fast);
            position: relative;
        }
        
        .result-action:after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary-color);
            transition: var(--transition-fast);
        }
        
        .result-action:hover:after {
            width: 100%;
        }
        
        .result-action:hover {
            color: var(--primary-color);
        }
        
        .result-action i {
            margin-right: 0.3rem;
            font-size: 1.1rem;
        }
        
        /* Search highlights */
        .search-highlight {
            background-color: rgba(255, 202, 40, 0.3);
            padding: 0 2px;
            border-radius: 2px;
            font-weight: 500;
            position: relative;
            display: inline-block;
        }
        
        .search-highlight:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: rgba(255, 202, 40, 0.5);
        }
        
        .search-term {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        /* Loading animation */
        .search-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            background-color: white;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-small);
        }
        
        .search-loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(30, 136, 229, 0.1);
            border-radius: 50%;
            border-top-color: var(--secondary-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }
        
        .search-loading-text {
            color: var(--text-secondary);
            text-align: center;
            animation: pulse 1.5s infinite;
        }
        
        .search-loading-progress {
            width: 200px;
            height: 4px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 2px;
            margin-top: 1rem;
            overflow: hidden;
            position: relative;
        }
        
        .search-loading-progress:after {
            content: '';
            position: absolute;
            top: 0;
            left: -50%;
            width: 50%;
            height: 100%;
            background-color: var(--secondary-color);
            animation: progressBar 1.5s ease-in-out infinite;
        }
        
        @keyframes progressBar {
            0% { left: -50%; }
            100% { left: 100%; }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* No results */
        .no-results {
            background-color: white;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-small);
            padding: 2rem;
            text-align: center;
            animation: fadeIn 0.5s forwards 0.5s;
            opacity: 0;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .no-results-icon {
            font-size: 4rem;
            color: rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
            animation: wobble 3s infinite alternate;
        }
        
        @keyframes wobble {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            75% { transform: translateX(10px) rotate(5deg); }
        }
        
        .no-results h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .no-results p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        
        /* Pagination */
        .search-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 3rem;
            gap: 0.5rem;
            flex-wrap: wrap;
            opacity: 0;
            animation: fadeIn 0.5s forwards 2.2s;
        }
        
        .pagination-btn {
            min-width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            background-color: white;
            color: var(--text-secondary);
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition-fast);
            box-shadow: var(--shadow-small);
            border: 1px solid rgba(0,0,0,0.1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .pagination-btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(30, 136, 229, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
            z-index: 0;
        }
        
        .pagination-btn:hover:before {
            width: 300%;
            height: 300%;
        }
        
        .pagination-btn:hover {
            background-color: var(--secondary-light);
            color: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        .pagination-btn.active {
            background-color: var(--secondary-color);
            color: white;
            transform: scale(1.1);
        }
        
        .pagination-nav {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            background-color: white;
            color: var(--text-secondary);
            transition: var(--transition-fast);
            box-shadow: var(--shadow-small);
            text-decoration: none;
            border: 1px solid rgba(0,0,0,0.1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .pagination-nav:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(30, 136, 229, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
            z-index: 0;
        }
        
        .pagination-nav:hover:before {
            width: 300%;
            height: 300%;
        }
        
        .pagination-nav:hover {
            background-color: var(--secondary-light);
            color: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        .pagination-nav.disabled {
            background-color: rgba(0, 0, 0, 0.05);
            color: rgba(0, 0, 0, 0.2);
            cursor: not-allowed;
            pointer-events: none;
        }
        
        /* Toast notifications */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .toast {
            background-color: white;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-large);
            padding: 1rem 1.5rem;
            margin-top: 10px;
            display: flex;
            align-items: center;
            animation: slideInRight 0.3s, fadeOut 0.5s 3s forwards;
            max-width: 300px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; transform: translateY(-20px); }
        }
        
        .toast-icon {
            margin-right: 0.8rem;
            color: var(--secondary-color);
            font-size: 1.5rem;
        }
        
        .toast-content {
            flex: 1;
        }
        
        .toast-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }
        
        .toast-message {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
                
        /* Responsive styles */
        @media (max-width: 1024px) {
            .search-results {
                flex-direction: column;
            }
            
            .result-filters {
                width: 100%;
                margin-bottom: 1.5rem;
            }
            
            .result-filters .filter-section {
                margin-bottom: 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .page-title {
                font-size: 1.8rem;
            }
            
            .sorting-options {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .sorting-options select {
                width: 100%;
            }
            
            .direct-match {
                flex-direction: column;
                text-align: center;
                padding: 1.2rem;
            }
            
            .direct-match-icon {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            
            .result-card {
                padding: 1.2rem;
            }
            
            .result-title {
                font-size: 1.1rem;
            }
            
            .pagination-btn, .pagination-nav {
                min-width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 576px) {
            .container {
                padding: 0 1rem;
            }
            
            .search-form {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .search-input {
                border-radius: var(--border-radius-medium);
                width: 100%;
            }
            
            .search-button {
                border-radius: var(--border-radius-medium);
                width: 100%;
                justify-content: center;
            }
            
            .search-suggestions-dropdown {
                width: 100%;
                top: calc(100% + 5px);
            }
            
            .result-meta {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .result-url {
                margin-top: 0.3rem;
            }
            
            .result-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .filter-option {
                padding: 0.5rem 0;
            }
            
            .pagination-btn, .pagination-nav {
                min-width: 35px;
                height: 35px;
            }
        }
    </style>
</head>
<body>
    <!-- Simple header since we're in standalone mode -->
    <header class="header">
        <div class="container header-container">
            <div class="logo">
                <img src="https://upload.wikimedia.org/wikipedia/ro/c/c4/Sigla_Poliția_Locală_România.png" alt="Logo Poliția Locală">
                <div class="logo-text">
                    <div class="logo-title">Poliția Locală</div>
                    <div class="logo-subtitle">Slobozia</div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Page Title -->
    <div class="page-title-container">
        <div class="page-title-bg"></div>
        <div class="page-title-content container">
            <div class="page-subtitle">Căutare</div>
            <h1 class="page-title">Rezultate Căutare</h1>
        </div>
    </div>
    
    <main>
        <div class="container search-container">
            <div class="search-header">
                <form class="search-form" id="search-form">
                    <input type="text" id="search-input" class="search-input" placeholder="Caută pe site..." autocomplete="off">
                    <button type="submit" class="search-button">
                        <i class="material-icons">search</i>
                        Caută
                    </button>
                </form>
                <div id="search-suggestions" class="search-suggestions-dropdown"></div>
                <div class="search-summary" id="search-summary">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <div id="direct-match-container">
                <!-- Will be populated by JavaScript if there's a direct match -->
            </div>
            
            <div class="search-results" id="search-results">
                <div class="result-filters">
                    <div class="filter-section">
                        <div class="filter-header">Tip Conținut</div>
                        <div class="filter-body">
                            <div class="filter-option">
                                <input type="checkbox" id="filter-all" name="content-type" value="all" checked>
                                <label for="filter-all">Toate</label>
                                <span class="filter-count" id="count-all">0</span>
                            </div>
                            <div class="filter-option">
                                <input type="checkbox" id="filter-page" name="content-type" value="page">
                                <label for="filter-page">Pagini</label>
                                <span class="filter-count" id="count-page">0</span>
                            </div>
                            <div class="filter-option">
                                <input type="checkbox" id="filter-document" name="content-type" value="document">
                                <label for="filter-document">Documente</label>
                                <span class="filter-count" id="count-document">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <div class="filter-header">Secțiuni</div>
                        <div class="filter-body">
                            <div class="filter-option">
                                <input type="checkbox" id="filter-all-sections" name="section" value="all" checked>
                                <label for="filter-all-sections">Toate secțiunile</label>
                            </div>
                            <div class="filter-option">
                                <input type="checkbox" id="filter-despre" name="section" value="despre">
                                <label for="filter-despre">Despre noi</label>
                            </div>
                            <div class="filter-option">
                                <input type="checkbox" id="filter-contact" name="section" value="contact">
                                <label for="filter-contact">Contact</label>
                            </div>
                            <div class="filter-option">
                                <input type="checkbox" id="filter-documente" name="section" value="documente">
                                <label for="filter-documente">Documente</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="result-list" id="result-list">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="search-pagination" id="search-pagination">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
    </main>
    
    <!-- Toast notification container -->
    <div class="toast-container" id="toast-container">
        <!-- Toast notifications will be dynamically added here -->
    </div>

    <!-- Include FlexSearch library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flexsearch/0.7.31/flexsearch.bundle.js"></script>
    
    <!-- Search implementation -->
    <script>
        // Mock data for demonstration (replace with your actual content)
        // In a real implementation, you would generate this data with a build script and include it as a separate JSON file
        const siteContent = [
            {
                id: 'home',
                url: '/index.html',
                title: 'Poliția Locală Slobozia - Pagina Principală',
                content: 'Poliția Locală Slobozia este instituția publică de interes local, cu personalitate juridică, aflată în subordinea Consiliului Local al Municipiului Slobozia, care exercită atribuții privind apărarea drepturilor și libertăților fundamentale ale persoanei, a proprietății private și publice, prevenirea și descoperirea infracțiunilor. Poliția Locală Slobozia își desfășoară activitatea în interesul comunității locale, exclusiv pe baza și în executarea legii, precum și a actelor autorității deliberative și ale celei executive ale administrației publice locale.',
                excerpt: 'Poliția Locală Slobozia este instituția publică de interes local, cu personalitate juridică, aflată în subordinea Consiliului Local al Municipiului Slobozia...',
                type: 'page',
                section: 'general'
            },
            {
                id: 'despre',
                url: '/despre/index.html',
                title: 'Despre Poliția Locală Slobozia',
                content: 'Poliția Locală Slobozia a fost înființată în baza Legii Poliției Locale nr. 155/2010 și a Hotărârii de Guvern nr. 1332/2010 pentru aprobarea Regulamentului-cadru de organizare și funcționare a poliției locale. Atribuțiile Poliției Locale Slobozia includ: asigurarea ordinii și liniștii publice, creșterea siguranței cetățeanului, prevenirea și combaterea încălcării normelor legale privind curățenia și comerțul stradal, protecția mediului, disciplina în construcții și afișajul stradal. Misiunea instituției este aceea de a fi permanent în slujba comunității locale și de a asigura respectarea drepturilor și libertăților fundamentale ale cetățenilor.',
                excerpt: 'Poliția Locală Slobozia a fost înființată în baza Legii Poliției Locale nr. 155/2010 și a Hotărârii de Guvern nr. 1332/2010...',
                type: 'page',
                section: 'despre'
            },
            {
                id: 'contact',
                url: '/contact/index.html',
                title: 'Contact Poliția Locală Slobozia',
                content: 'Adresă: Str. Răzoare nr. 3, Slobozia, Județul Ialomița Telefon: 0243 955 Fax: 0243 233 771 Email: politia.locala@sloboziail.ro Program de lucru: Luni-Vineri: 08:00-16:00 Dispecerat: program non-stop Pentru urgențe: Telefon: 0243 955 (disponibil 24/7)',
                excerpt: 'Adresă: Str. Răzoare nr. 3, Slobozia, Județul Ialomița Telefon: 0243 955 Fax: 0243 233 771 Email: politia.locala@sloboziail.ro',
                type: 'page',
                section: 'contact'
            },
            {
                id: 'doc-hcl-2022',
                url: '/documente/hotarare-consiliu-2022.pdf',
                title: 'Hotărâre Consiliu Local privind organizarea Poliției Locale Slobozia',
                content: 'HOTĂRÂRE privind aprobarea Regulamentului de Organizare și Funcționare a Poliției Locale a Municipiului Slobozia Consiliul Local al Municipiului Slobozia, județul Ialomița, întrunit în ședința ordinară din data de 15.03.2022, Având în vedere: Referatul de aprobare al Primarului Municipiului Slobozia; Raportul de specialitate al Direcției Poliția Locală; Prevederile Legii nr. 155/2010 a Poliției Locale, republicată, cu modificările și completările ulterioare; Avizul comisiei de specialitate din cadrul Consiliului Local Slobozia; În temeiul prevederilor art. 129 alin. (2) lit. a) și alin. (3) lit. c), precum și art. 139 alin. (1) din OUG nr. 57/2019 privind Codul Administrativ, HOTĂRĂȘTE: Art. 1. Se aprobă Regulamentul de Organizare și Funcționare a Poliției Locale a Municipiului Slobozia, conform Anexei care face parte integrantă din prezenta hotărâre. Art. 2. La data intrării în vigoare a prezentei hotărâri se abrogă Hotărârea Consiliului Local nr. 45/28.02.2019. Art. 3. Primarul Municipiului Slobozia, prin Direcția Poliția Locală, va aduce la îndeplinire prevederile prezentei hotărâri. Art. 4. Prezenta hotărâre va fi comunicată prin grija Secretarului General al Municipiului Slobozia, Primarului Municipiului Slobozia, Direcției Poliția Locală și Instituției Prefectului - Județul Ialomița.',
                excerpt: 'HOTĂRÂRE privind aprobarea Regulamentului de Organizare și Funcționare a Poliției Locale a Municipiului Slobozia Consiliul Local al Municipiului Slobozia...',
                type: 'document',
                section: 'documente',
                extension: 'pdf'
            },
            {
                id: 'doc-regulament',
                url: '/documente/regulament-organizare-functionare.pdf',
                title: 'Regulament de Organizare și Funcționare',
                content: 'REGULAMENT DE ORGANIZARE ȘI FUNCȚIONARE A POLIȚIEI LOCALE A MUNICIPIULUI SLOBOZIA CAPITOLUL I Dispoziții generale Art. 1. Prezentul Regulament de Organizare și Funcționare a Poliției Locale a Municipiului Slobozia, denumit în continuare Regulament, reglementează organizarea și funcționarea Poliției Locale a Municipiului Slobozia, ca serviciu public de interes local, specializat, al Municipiului Slobozia. Art. 2. Poliția Locală a Municipiului Slobozia se organizează și funcționează în baza prevederilor Legii Poliției Locale nr. 155/2010, republicată, cu modificările și completările ulterioare, ale Hotărârii Guvernului nr. 1332/2010 privind aprobarea Regulamentului-cadru de organizare și funcționare a poliției locale, ale Legii administrației publice locale nr. 215/2001, republicată, cu modificările și completările ulterioare, precum și ale prezentului Regulament. Art. 3. (1) Poliția Locală a Municipiului Slobozia se înființează în scopul exercitării atribuțiilor privind apărarea drepturilor și libertăților fundamentale ale persoanei, a proprietății private și publice, prevenirea și descoperirea infracțiunilor, în următoarele domenii: a) ordinea și liniștea publică, precum și paza bunurilor; b) circulația pe drumurile publice; c) disciplina în construcții și afișajul stradal; d) protecția mediului; e) activitatea comercială; f) evidența persoanelor; g) alte domenii stabilite prin lege. (2) Poliția Locală a Municipiului Slobozia își desfășoară activitatea pe baza principiilor: legalității, încrederii, previzibilității, proximității și proporționalității, deschiderii și transparenței, eficienței și eficacității, răspunderii și responsabilității, imparțialității și nediscriminării.',
                excerpt: 'REGULAMENT DE ORGANIZARE ȘI FUNCȚIONARE A POLIȚIEI LOCALE A MUNICIPIULUI SLOBOZIA CAPITOLUL I Dispoziții generale Art. 1. Prezentul Regulament...',
                type: 'document',
                section: 'documente',
                extension: 'pdf'
            },
            {
                id: 'doc-raport-2023',
                url: '/documente/raport-activitate-2023.pdf',
                title: 'Raport de activitate 2023',
                content: 'RAPORT PRIVIND ACTIVITATEA POLIȚIEI LOCALE A MUNICIPIULUI SLOBOZIA PE ANUL 2023 I. INTRODUCERE Prezentul raport de activitate este elaborat în conformitate cu prevederile Legii Poliției Locale nr. 155/2010, republicată, cu modificările și completările ulterioare, și ale H.G. nr. 1332/2010 pentru aprobarea Regulamentului-cadru de organizare și funcționare a poliției locale. Poliția Locală a Municipiului Slobozia funcționează ca instituție publică de interes local, cu personalitate juridică, aflată în subordinea Consiliului Local al Municipiului Slobozia și sub directa coordonare a Primarului Municipiului Slobozia. Pe parcursul anului 2023, polițiștii locali din cadrul Poliției Locale a Municipiului Slobozia au desfășurat activități în vederea prevenirii și combaterii faptelor antisociale, au asigurat protecția și respectarea drepturilor și libertăților fundamentale ale cetățenilor, a proprietății publice și private, precum și măsuri de protecție a populației, în limitele competențelor stabilite prin lege. II. STRUCTURA ORGANIZATORICĂ La nivelul anului 2023, Poliția Locală a Municipiului Slobozia a funcționat cu un număr de 65 de angajați, din care 60 de polițiști locali și 5 personal contractual, organizați astfel: - Director executiv: 1 - Serviciul Ordine și Liniște Publică: 30 polițiști locali - Biroul Circulație pe Drumurile Publice: 10 polițiști locali - Biroul Control Activități Comerciale: 6 polițiști locali - Biroul Disciplină în Construcții și Afișaj Stradal: 5 polițiști locali - Compartimentul Protecția Mediului: 4 polițiști locali - Compartimentul Evidența Persoanelor: 4 polițiști locali - Compartimentul Administrativ: 5 personal contractual III. ACTIVITĂȚI DESFĂȘURATE ÎN ANUL 2023 1. În domeniul ordinii și liniștii publice În cursul anului 2023, polițiștii locali din cadrul Serviciului Ordine și Liniște Publică au desfășurat următoarele activități: - Acțiuni de patrulare: 1.825 - Contravenții constatate: 2.340 - Valoarea amenzilor aplicate: 845.600 lei - Infracțiuni constatate: 12 - Persoane legitimate: 14.520 - Sesizări și reclamații soluționate: 1.235 - Măsuri de ordine asigurate la manifestări culturale, sportive, religioase: 65',
                excerpt: 'RAPORT PRIVIND ACTIVITATEA POLIȚIEI LOCALE A MUNICIPIULUI SLOBOZIA PE ANUL 2023 I. INTRODUCERE Prezentul raport de activitate este elaborat în conformitate cu prevederile Legii Poliției Locale...',
                type: 'document',
                section: 'documente',
                extension: 'pdf'
            },
            {
                id: 'doc-cerere-petitie',
                url: '/documente/formular-petitie.docx',
                title: 'Formular Petiție către Poliția Locală',
                content: 'PETIȚIE Către Poliția Locală a Municipiului Slobozia Subsemnatul/Subsemnata ... domiciliat/ă în ... posesor/posesoare al/a C.I. seria ... nr. ... eliberată de ... la data de ... CNP ... telefon ... email ... În conformitate cu prevederile O.G. nr. 27/2002 privind reglementarea activității de soluționare a petițiilor, cu modificările și completările ulterioare, formulez prezenta PETIȚIE prin care vă aduc la cunoștință următoarele: ... (descrierea situației, aspectelor sesizate, data și locul unde s-au produs evenimentele, persoanele implicate, etc.) Menționez că această situație contravine prevederilor ... (se menționează, dacă se cunosc, actele normative considerate a fi încălcate) Față de cele prezentate, vă rog să dispuneți măsurile legale pentru soluționarea aspectelor sesizate și să-mi comunicați modul de soluționare. Anexez prezentei următoarele documente: ... Data: ... Semnătura: ... Notă: Datele cu caracter personal sunt prelucrate în conformitate cu prevederile Regulamentului (UE) nr. 2016/679 privind protecția persoanelor fizice în ceea ce privește prelucrarea datelor cu caracter personal și libera circulație a acestor date.',
                excerpt: 'PETIȚIE Către Poliția Locală a Municipiului Slobozia Subsemnatul/Subsemnata ... domiciliat/ă în ... posesor/posesoare al/a C.I. seria ... nr. ... eliberată de ... la data de ...',
                type: 'document',
                section: 'documente',
                extension: 'docx'
            },
            {
                id: 'servicii',
                url: '/servicii/index.html',
                title: 'Serviciile Poliției Locale Slobozia',
                content: 'Poliția Locală Slobozia oferă următoarele servicii pentru cetățeni și instituții: 1. Asigurarea ordinii și liniștii publice în zonele și locurile stabilite prin Planul de ordine și siguranță publică; 2. Fluidizarea circulației rutiere și pietonale; 3. Supravegherea parcărilor publice; 4. Verificarea respectării normelor legale privind comerțul stradal; 5. Verificarea respectării normelor legale privind disciplina în construcții; 6. Verificarea respectării normelor de protecție a mediului; 7. Verificarea respectării normelor legale privind afișajul publicitar; 8. Verificarea respectării normelor legale privind evidența persoanelor; 9. Asigurarea protecției personalului din aparatul de specialitate al primarului, din instituțiile sau serviciile publice de interes local; 10. Intervenția la solicitările dispeceratului la evenimentele semnalate prin Serviciul de urgență 112; 11. Primirea și soluționarea petițiilor cetățenilor; 12. Monitorizarea video a domeniului public; 13. Acțiuni comune cu Poliția Națională și alte instituții ale statului; 14. Acțiuni de informare și educare a cetățenilor; 15. Acțiuni de verificare a imobilelor abandonate.',
                excerpt: 'Poliția Locală Slobozia oferă următoarele servicii pentru cetățeni și instituții: 1. Asigurarea ordinii și liniștii publice în zonele și locurile stabilite prin Planul de ordine și siguranță publică...',
                type: 'page',
                section: 'general'
            }
        ];

        // Initialize FlexSearch
        const initializeSearchIndex = () => {
            // Create document index
            const documentIndex = new FlexSearch.Document({
                document: {
                    id: "id",
                    index: [
                        "title",
                        "content",
                        "url"
                    ],
                    store: [
                        "title", 
                        "url", 
                        "excerpt", 
                        "type", 
                        "section", 
                        "extension"
                    ]
                },
                tokenize: "forward",
                charset: "latin:extra",
                language: "ro", // For Romanian
                optimize: true,
                cache: 100,
                worker: navigator.hardwareConcurrency || 4 // Use available CPU cores
            });

            // Add documents to index
            siteContent.forEach(doc => {
                documentIndex.add(doc);
            });

            return documentIndex;
        };

        // Initialize search when document is ready
        let searchIndex;
        let recentSearches = [];
        const MAX_RECENT_SEARCHES = 10;
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize search index
            searchIndex = initializeSearchIndex();
            
            // Load recent searches from localStorage
            try {
                const storedSearches = localStorage.getItem('pls_recent_searches');
                if (storedSearches) {
                    recentSearches = JSON.parse(storedSearches);
                }
            } catch (e) {
                console.warn('Failed to load recent searches from localStorage', e);
            }
            
            // Set up search form handler
            setupSearchHandlers();
            
            // Check URL for search query on page load
            const urlParams = new URLSearchParams(window.location.search);
            const query = urlParams.get('q');
            
            if (query) {
                const searchInput = document.getElementById('search-input');
                if (searchInput) {
                    searchInput.value = query;
                }
                performSearch(query);
            }
        });

        // Store recent searches
        function addToRecentSearches(query) {
            if (!query || query.length < 3) return;
            
            // Remove if already exists and add to beginning
            recentSearches = recentSearches.filter(item => item !== query);
            recentSearches.unshift(query);
            
            // Limit size
            if (recentSearches.length > MAX_RECENT_SEARCHES) {
                recentSearches = recentSearches.slice(0, MAX_RECENT_SEARCHES);
            }
            
            // Store in localStorage
            try {
                localStorage.setItem('pls_recent_searches', JSON.stringify(recentSearches));
            } catch (e) {
                console.warn('Failed to save recent searches to localStorage', e);
            }
        }

        // Set up search event handlers
        function setupSearchHandlers() {
            const searchForm = document.getElementById('search-form');
            const searchInput = document.getElementById('search-input');
            const suggestionsDropdown = document.getElementById('search-suggestions');
            
            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const query = searchInput.value.trim();
                    if (query) {
                        performSearch(query);
                    }
                });
            }
            
            if (searchInput) {
                // Set up real-time suggestions
                searchInput.addEventListener('input', function() {
                    const query = this.value.trim();
                    if (query.length >= 2) {
                        // Get suggestions
                        const suggestions = getSearchSuggestions(query, 5);
                        if (suggestions.length > 0) {
                            renderSuggestions(suggestions);
                            suggestionsDropdown.classList.add('active');
                        } else {
                            suggestionsDropdown.classList.remove('active');
                        }
                    } else {
                        suggestionsDropdown.classList.remove('active');
                    }
                });
            }
            
            // Set up filter handlers
            document.querySelectorAll('input[name="content-type"]').forEach(input => {
                input.addEventListener('change', function() {
                    if (this.checked && this.value !== 'all') {
                        // Uncheck "All" option
                        document.getElementById('filter-all').checked = false;
                        
                        // Apply filter
                        const query = searchInput.value.trim();
                        if (query) {
                            performSearch(query);
                        }
                    } else if (this.checked && this.value === 'all') {
                        // Uncheck other options
                        document.querySelectorAll('input[name="content-type"]').forEach(otherInput => {
                            if (otherInput.value !== 'all') {
                                otherInput.checked = false;
                            }
                        });
                        
                        // Apply filter
                        const query = searchInput.value.trim();
                        if (query) {
                            performSearch(query);
                        }
                    }
                });
            });
            
            // Set up section filter handlers
            document.querySelectorAll('input[name="section"]').forEach(input => {
                input.addEventListener('change', function() {
                    if (this.checked && this.value !== 'all') {
                        // Uncheck "All" option
                        document.getElementById('filter-all-sections').checked = false;
                        
                        // Apply filter
                        const query = searchInput.value.trim();
                        if (query) {
                            performSearch(query);
                        }
                    } else if (this.checked && this.value === 'all') {
                        // Uncheck other options
                        document.querySelectorAll('input[name="section"]').forEach(otherInput => {
                            if (otherInput.value !== 'all') {
                                otherInput.checked = false;
                            }
                        });
                        
                        // Apply filter
                        const query = searchInput.value.trim();
                        if (query) {
                            performSearch(query);
                        }
                    }
                });
            });
        }

        // Get search suggestions
        function getSearchSuggestions(query, maxSuggestions = 5) {
            if (!query || query.length < 2) return [];
            
            const normalizedQuery = query.toLowerCase();
            const suggestions = new Set();
            
            // Add from recent searches
            recentSearches.forEach(search => {
                if (search.toLowerCase().includes(normalizedQuery)) {
                    suggestions.add(search);
                }
            });
            
            // If we have enough suggestions from recent searches, return them
            if (suggestions.size >= maxSuggestions) {
                return Array.from(suggestions).slice(0, maxSuggestions);
            }
            
            // Add from site content titles
            siteContent.forEach(item => {
                if (item.title.toLowerCase().includes(normalizedQuery)) {
                    const titleParts = item.title.split(' ');
                    for (let i = 0; i < titleParts.length; i++) {
                        const phrase = titleParts.slice(i, Math.min(i + 3, titleParts.length)).join(' ');
                        if (phrase.toLowerCase().includes(normalizedQuery) && phrase.length > query.length) {
                            suggestions.add(phrase);
                        }
                    }
                }
            });
            
            return Array.from(suggestions).slice(0, maxSuggestions);
        }

        // Render search suggestions
        function renderSuggestions(suggestions) {
            const container = document.getElementById('search-suggestions');
            if (!container) return;
            
            container.innerHTML = '';
            
            // Create suggestion elements
            const ul = document.createElement('ul');
            suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = '#';
                a.innerHTML = `<i class="material-icons">search</i>${suggestion}`;
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('search-input').value = suggestion;
                    performSearch(suggestion);
                    container.classList.remove('active');
                });
                li.appendChild(a);
                ul.appendChild(li);
            });
            
            container.appendChild(ul);
        }

        // Perform search
        function performSearch(query, page = 1) {
            // Update URL
            const url = new URL(window.location);
            url.searchParams.set('q', query);
            url.searchParams.set('page', page);
            window.history.pushState({}, '', url);
            
            // Clear suggestions
            const suggestionsContainer = document.getElementById('search-suggestions');
            if (suggestionsContainer) {
                suggestionsContainer.classList.remove('active');
            }
            
            // Show loading state
            showSearchLoading();
            
            // Add to recent searches
            addToRecentSearches(query);
            
            // Get filter values
            let typeFilter = null;
            let sectionFilter = null;
            
            // Check if any type filter is selected
            document.querySelectorAll('input[name="content-type"]:checked').forEach(input => {
                if (input.value !== 'all') {
                    typeFilter = input.value;
                }
            });
            
            // Check if any section filter is selected
            document.querySelectorAll('input[name="section"]:checked').forEach(input => {
                if (input.value !== 'all') {
                    sectionFilter = input.value;
                }
            });
            
            // Perform search
            const results = searchIndex.search(query, {
                limit: 100,
                suggest: true, // Enable suggestions (fuzzy search)
                enrich: true // Return full document data
            });
            
            // Process results
            let allResults = [];
            
            // Combine results from all fields
            results.forEach(resultSet => {
                resultSet.result.forEach(result => {
                    // Add if not already in results
                    if (!allResults.some(r => r.id === result.id)) {
                        allResults.push(result);
                    }
                });
            });
            
            // Apply filters
            if (typeFilter) {
                allResults = allResults.filter(result => result.type === typeFilter);
            }
            
            if (sectionFilter) {
                allResults = allResults.filter(result => result.section === sectionFilter);
            }
            
            // Sort by relevance (assuming first results are most relevant)
            
            // Pagination
            const perPage = 10;
            const totalResults = allResults.length;
            const totalPages = Math.ceil(totalResults / perPage);
            const startIndex = (page - 1) * perPage;
            const endIndex = Math.min(startIndex + perPage, totalResults);
            
            // Get current page results
            const paginatedResults = allResults.slice(startIndex, endIndex);
            
            // Render results
            setTimeout(() => {
                renderSearchResults({
                    query,
                    results: paginatedResults,
                    totalResults,
                    currentPage: page,
                    totalPages,
                    perPage,
                    // Identify direct match (first result with high relevance)
                    directMatch: allResults.length > 0 ? allResults[0] : null
                });
            }, 500); // Small delay to show loading animation
        }

        // Show loading state
        function showSearchLoading() {
            const resultList = document.getElementById('result-list');
            if (resultList) {
                resultList.innerHTML = `
                    <div class="search-loading">
                        <div class="search-loading-spinner"></div>
                        <p class="search-loading-text">Se încarcă rezultatele căutării...</p>
                        <div class="search-loading-progress"></div>
                    </div>
                `;
            }
            
            // Reset pagination
            document.getElementById('search-pagination').innerHTML = '';
            
            // Hide direct match
            const directMatchContainer = document.getElementById('direct-match-container');
            if (directMatchContainer) {
                directMatchContainer.innerHTML = '';
            }
        }

        // Render search results
        function renderSearchResults(result) {
            // Update summary
            const searchSummary = document.getElementById('search-summary');
            if (searchSummary) {
                searchSummary.innerHTML = `
                    S-au găsit <strong>${result.totalResults}</strong> rezultate pentru 
                    <span class="search-term">"${result.query}"</span>
                `;
            }
            
            // Update direct match if exists
            const directMatchContainer = document.getElementById('direct-match-container');
            if (directMatchContainer && result.directMatch) {
                const directMatch = result.directMatch;
                directMatchContainer.innerHTML = `
                    <div class="direct-match">
                        <div class="direct-match-icon">
                            <i class="material-icons">${directMatch.type === 'document' ? 'description' : 'find_in_page'}</i>
                        </div>
                        <div class="direct-match-content">
                            <h3>Rezultat exact găsit</h3>
                            <p>${highlightSearchTerms(directMatch.title, result.query)}</p>
                            <a href="${directMatch.url}" class="direct-match-link">
                                Accesează direct
                                <i class="material-icons">arrow_forward</i>
                            </a>
                        </div>
                    </div>
                `;
            }
            
            // Update filter counts
            updateFilterCounts(result);
            
            // Display results
            if (result.totalResults > 0) {
                displaySearchResults(result);
                displayPagination(result.totalPages, result.currentPage);
            } else {
                showNoResultsState(result.query);
            }
            
            // Show toast notification
            showToast('search', 'Căutare finalizată', `S-au găsit ${result.totalResults} rezultate`);
        }

        // Update filter counts
        function updateFilterCounts(result) {
            // Count by type
            const typeCounts = {
                all: result.totalResults,
                page: 0,
                document: 0
            };
            
            // Count from results
            result.results.forEach(hit => {
                if (hit.type && typeCounts[hit.type] !== undefined) {
                    typeCounts[hit.type]++;
                }
            });
            
            // Also count from all results (not just paginated)
            siteContent.forEach(item => {
                // Check if this item matches the search query
                const searchIndex = initializeSearchIndex();
                const queryResults = searchIndex.search(result.query);
                const isMatch = queryResults.some(rs => rs.result.some(r => r.id === item.id));
                
                if (isMatch) {
                    if (item.type === 'page') typeCounts.page++;
                    if (item.type === 'document') typeCounts.document++;
                }
            });
            
            // Update DOM
            Object.keys(typeCounts).forEach(type => {
                const countElement = document.getElementById(`count-${type}`);
                if (countElement) {
                    countElement.textContent = type === 'all' ? result.totalResults : typeCounts[type];
                }
            });
        }

        // Display search results
        function displaySearchResults(result) {
            const resultList = document.getElementById('result-list');
            if (!resultList) return;
            
            resultList.innerHTML = '';
            
            // Create result cards
            result.results.forEach(hit => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card';
                
                // Determine icon based on type
                let typeIcon = 'article';
                let typeLabel = 'Pagină';
                
                if (hit.type === 'document') {
                    typeIcon = 'description';
                    typeLabel = 'Document';
                    
                    // Specific icon based on extension
                    if (hit.extension) {
                        if (hit.extension === 'pdf') {
                            typeIcon = 'picture_as_pdf';
                            typeLabel = 'PDF';
                        } else if (['doc', 'docx'].includes(hit.extension)) {
                            typeIcon = 'description';
                            typeLabel = 'Document Word';
                        } else if (['xls', 'xlsx'].includes(hit.extension)) {
                            typeIcon = 'table_chart';
                            typeLabel = 'Excel';
                        }
                    }
                }
                
                // Format title with highlighting
                const highlightedTitle = highlightSearchTerms(hit.title, result.query);
                
                // Format content excerpt with highlighting
                const highlightedExcerpt = highlightSearchTerms(hit.excerpt, result.query);
                
                resultCard.innerHTML = `
                    <div class="result-meta">
                        <div class="result-type">
                            <i class="material-icons">${typeIcon}</i>${typeLabel}
                        </div>
                        <a href="${hit.url}" class="result-url" title="${hit.url}">${hit.url}</a>
                    </div>
                    <h3 class="result-title"><a href="${hit.url}">${highlightedTitle}</a></h3>
                    <div class="result-excerpt">${highlightedExcerpt}</div>
                    <div class="result-actions">
                        <a href="${hit.url}" class="result-action">
                            <i class="material-icons">open_in_new</i> Vizitează
                        </a>
                        <a href="#" class="result-action" onclick="shareResult('${hit.url}', '${escapeHtml(hit.title)}'); return false;">
                            <i class="material-icons">share</i> Distribuie
                        </a>
                    </div>
                `;
                
                resultList.appendChild(resultCard);
            });
        }

        // Highlight search terms in text
        function highlightSearchTerms(text, query) {
            if (!text || !query) return text;
            
            const words = query.toLowerCase().split(/\s+/).filter(w => w.length > 2);
            
            let highlightedText = text;
            
            // Sort words by length (longest first) to prevent highlighting partial words
            words.sort((a, b) => b.length - a.length);
            
            // Replace each word with highlighted version
            words.forEach(word => {
                const regex = new RegExp(`(${escapeRegExp(word)})`, 'gi');
                highlightedText = highlightedText.replace(regex, '<span class="search-highlight">$1</span>');
            });
            
            return highlightedText;
        }

        // Helper function to escape special characters in regex
        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Display pagination
        function displayPagination(totalPages, currentPage) {
            const paginationContainer = document.getElementById('search-pagination');
            if (!paginationContainer) return;
            
            if (totalPages <= 1) {
                paginationContainer.innerHTML = '';
                return;
            }
            
            let paginationHtml = '';
            
            // Previous page button
            const prevDisabled = currentPage <= 1 ? 'disabled' : '';
            paginationHtml += `
                <a href="#" onclick="navigateToPage(${currentPage - 1}); return false;" 
                   class="pagination-nav ${prevDisabled}">
                  <i class="material-icons">chevron_left</i>
                </a>
            `;
            
            // Page numbers
            const maxDisplayedPages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxDisplayedPages / 2));
            let endPage = Math.min(totalPages, startPage + maxDisplayedPages - 1);
            
            // Adjust start page if end page is maximum
            if (endPage === totalPages) {
                startPage = Math.max(1, endPage - maxDisplayedPages + 1);
            }
            
            // First page
            if (startPage > 1) {
                paginationHtml += `
                    <a href="#" onclick="navigateToPage(1); return false;" class="pagination-btn">1</a>
                `;
                
                if (startPage > 2) {
                    paginationHtml += '<span class="pagination-ellipsis">...</span>';
                }
            }
            
            // Page numbers
            for (let i = startPage; i <= endPage; i++) {
                const activeClass = i === currentPage ? 'active' : '';
                paginationHtml += `
                    <a href="#" onclick="navigateToPage(${i}); return false;" 
                       class="pagination-btn ${activeClass}">${i}</a>
                `;
            }
            
            // Last page
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    paginationHtml += '<span class="pagination-ellipsis">...</span>';
                }
                
                paginationHtml += `
                    <a href="#" onclick="navigateToPage(${totalPages}); return false;" 
                       class="pagination-btn">${totalPages}</a>
                `;
            }
            
            // Next page button
            const nextDisabled = currentPage >= totalPages ? 'disabled' : '';
            paginationHtml += `
                <a href="#" onclick="navigateToPage(${currentPage + 1}); return false;" 
                   class="pagination-nav ${nextDisabled}">
                  <i class="material-icons">chevron_right</i>
                </a>
            `;
            
            paginationContainer.innerHTML = paginationHtml;
        }

        // Show no results state
        function showNoResultsState(query) {
            const resultList = document.getElementById('result-list');
            if (!resultList) return;
            
            resultList.innerHTML = `
                <div class="no-results">
                    <div class="no-results-icon"><i class="material-icons">search_off</i></div>
                    <h3>Nu s-au găsit rezultate</h3>
                    <p>Nu am găsit niciun rezultat pentru <strong>"${query}"</strong>.</p>
                    <p>Sugestii:</p>
                    <ul>
                        <li>Verificați ortografia cuvintelor cheie.</li>
                        <li>Încercați cuvinte cheie diferite.</li>
                        <li>Încercați cuvinte cheie mai generale.</li>
                    </ul>
                </div>
            `;
        }

        // Navigation function for pagination
        function navigateToPage(page) {
            const url = new URL(window.location);
            const query = url.searchParams.get('q') || '';
            
            // Update URL parameters
            url.searchParams.set('page', page);
            window.history.pushState({}, '', url);
            
            // Execute search with updated page
            performSearch(query, page);
        }

        // Share result function
        function shareResult(url, title) {
            if (navigator.share) {
                navigator.share({
                    title: title,
                    url: url
                }).catch(err => {
                    console.error('Share failed:', err);
                    copyToClipboard(url);
                });
            } else {
                copyToClipboard(url);
            }
        }

        // Copy to clipboard
        function copyToClipboard(text) {
            const tempInput = document.createElement('input');
            document.body.appendChild(tempInput);
            tempInput.value = text;
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            
            showToast('content_copy', 'Link copiat', 'Link-ul a fost copiat în clipboard!');
        }

        // Show toast notification
        function showToast(icon, title, message) {
            const toastContainer = document.getElementById('toast-container');
            if (!toastContainer) return;
            
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="material-icons">${icon}</i>
                </div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Auto-remove toast after animation completes
            setTimeout(() => {
                toast.remove();
            }, 3500);
        }

        // Make functions available globally
        window.navigateToPage = navigateToPage;
        window.shareResult = shareResult;
    </script>
</body>
</html>
